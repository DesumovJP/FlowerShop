#!/bin/bash

echo "üîÑ –ü–µ—Ä–µ–±—É–¥–æ–≤–∞ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è Strapi..."

# –ó—É–ø–∏–Ω—è—î–º–æ —Ç–∞ –≤–∏–¥–∞–ª—è—î–º–æ —ñ—Å–Ω—É—é—á—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏
echo "üõë –ó—É–ø–∏–Ω—è—î–º–æ —ñ—Å–Ω—É—é—á—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏..."
docker-compose down

# –í–∏–¥–∞–ª—è—î–º–æ —Å—Ç–∞—Ä–∏–π –æ–±—Ä–∞–∑
echo "üóëÔ∏è –í–∏–¥–∞–ª—è—î–º–æ —Å—Ç–∞—Ä–∏–π –æ–±—Ä–∞–∑..."
docker rmi flowershop3-strapi 2>/dev/null || true

# –û—á–∏—â–∞—î–º–æ –∫–µ—à Docker
echo "üßπ –û—á–∏—â–∞—î–º–æ –∫–µ—à Docker..."
docker system prune -f

# –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É –¥–ª—è uploads –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó
echo "üìÅ –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É –¥–ª—è uploads..."
sudo chown -R 1001:1001 ./uploads 2>/dev/null || chown -R 1001:1001 ./uploads
chmod -R 755 ./uploads

# –ü–µ—Ä–µ–±—É–¥–æ–≤—É—î–º–æ —Ç–∞ –∑–∞–ø—É—Å–∫–∞—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏
echo "üî® –ü–µ—Ä–µ–±—É–¥–æ–≤—É—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏..."
docker-compose build --no-cache

echo "üöÄ –ó–∞–ø—É—Å–∫–∞—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏..."
docker-compose up -d

echo "‚úÖ –ì–æ—Ç–æ–≤–æ! Strapi –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ http://localhost:1337"
echo "üìä –î–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –ª–æ–≥—ñ–≤: docker-compose logs -f strapi"














